Aktuell:
- Urlaubseintragsliste: fetcht zuviel (replacements must or loaded at once on afterload).
- 2024-11-09T16:18:19.834Z user:kai  WARN 23413 --- [projectforge-application] [0.1-8080-exec-2] o.p.business.user.AbstractUserPrefCache  : Can't deserialize user preferences: null, userId=2, area=null, key='TeamCalendarPage.userPrefs' (may-be ok after a new ProjectForge release). string=!rO0AB...vnj7nRSToOXX1PrEWobDsFAAA=

- remove all BaseDO.xxxId (lazy fetch) and replace callee by baseDO?.id
- Entitygraphen nutzen: ConflictVacationCache, AuftragCache etc.
  - Auftrag editieren: massenhaft SQLs
  - employeeSalaryList: lädt wie blöde nach dem Editieren. (Excel-Exports auch zuviele SQLs)
  - AddressKampagnen: ebd. (massenhaft SQLs)
- Suche nach Kontonummer in KontoDO

- Lazy-Breakpoint: AbstractLazyInitializer.initialize (#134)
org.hibernate.persister.entity.AbstractEntityPersister#generateSelectLazy:

postrgesql.conf:
 log_lock_waits = on
 deadlock_timeout = '500ms'
 log_min_duration_statement = 1000  # Optional: loggt Abfragen, die länger als 1 Sekunde dauern


- Suche:
  - Suche in Urlaubskorrekturen
  - Suche in History
- HistoryConvertContext: Am Ende alle displayProperties übernehmen.

- ProjektEdit: History enthält keine neuen Kost2DOs/Arten (Einträge sind aber da).
- CronReindexingHourlyJob ohne Effekt.
- Protokoll einsehen: http://localhost:8080/react/logViewer/dynamic/1
- Reindizierung der letzten n einträge nicht migriert (sinnvoll?).
- history-entries bei EmployeeValidityAttrDO nichtssagend.
- HistoryEntry: EmployeeValidityAttrDO.insert muss sinnvoll für Anzeige formatiert werden.
- Scripte nach Renamings testen
- Cascade aller Entitäten prüfen (z. B. war GroupTaskAccessDO.task auf Merged!!!!) Abgleich mit autoUpdateCollectionEntries (evtl. kann auf autoUpdateCollectionEntries verzichtet werden, zumindest aber Sanity-Check in CandH.)
- PFHistoryMasterDO: Indexe setzen, wenn Einträge wieder gehen.
- XML-Import für Testsystem
- TypeBinding: ProjektDO, Kost1DO, Kost2DO, ...: Add path to list of searchable items
- @WithHistory: AuftragDO, TeamEventDO
- UserRights zu Benutzer hinzufügen testen (Reihenfolge update/save wichtig)
- ICalGeneratorParserTest
- UserRightId: ClassBridge müsste eigentlich in die Felder der benutzenden DOs
- Script-Parameter: intValue ist nun long!?
- StringHelper: splitToLongs/LongObjects OK?
- SetupPage testen
- reindexing settings implementieren. Aktuell wird nur komplett gemass-indexed.
- History of AddressCampaignValueDO's (AddressCampaignValueDao.convertToDisplayHistoryEntries removed)

Später
- Hibernate-Search: K+S etc.
- Besuchsbuch und EmployeeValidSinceAttr: DisplayEntries von Besuchtagen mit Datum des Besuchs versehen.
- Suche-Seite hat veraltete Bereiche, AddressListPage läuft auf Fehler.
- OrderExport: paymentSchedules werden gefetcht.
- Update caches after single load or modification.

Ganz später
- Kalenderlist ruft x-fach DB: FIND GroupDO resultClass=GroupDO auf.

- pom.xml:
Some problems were encountered while building the effective model for org.projectforge:projectforge-business:jar:7.5.1-SNAPSHOT
[WARNING] 'dependencies.dependency.(groupId:artifactId:type:classifier)' must be unique: org.springframework.boot:spring-boot-starter-cache:jar -> version (?) vs ${spring.boot.version} @ line 188, column 21
[WARNING]
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING]
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.

Migration employee timed attrs:
select a.createdat, a.createdby, a.modifiedat, a.modifiedby, a.start_time, a.end_time, a.employee_id, a.group_name, b.value, b.propertyname, b.createdby, b.createdat, b.modifiedby, b.modifiedat from t_fibu_employee_timed a JOIN t_fibu_employee_timedattr b ON a.pk=b.parent;

employeestatus
employeeannualleave

- Produktion:
  # In postgresql.conf (Neustart der Datenbank erforderlich)
  lock_timeout = '300s'   # 5 minutes timeout for locks.
  statement_timeout = '300s'   # 5 minutes timeout for SQL-commands.


Rollback:
update t_configuration set configurationtype='INTEGER' where configurationtype='LONG';
ALTER TABLE t_configuration ALTER COLUMN longvalue RENAME TO intvalue;


Scripts:
Faktura-Quote nach KJ/GJ
 - import java.util.Objects
 - 114: EmployeeCache.instance.getEmployeeByUserId
 - 37: data class User(val id: Long?, val username: String, val name: String, val firstName: String) : Comparable<User> {
 - 266: var useYear = jahr?.toInt() ?: LocalDate.now().year
 -

